/**
 * rubico v1.9.2
 * https://github.com/a-synchronous/rubico
 * (c) 2019-2021 Richard Tong
 * rubico may be freely distributed under the MIT license.
 */

!function(n,t){"object"==typeof module?module.exports=t:"function"==typeof define?define((()=>t)):n.filterOut=t}("object"==typeof globalThis?globalThis:this,function(){"use strict";const n=Symbol.for("placeholder"),t=Symbol.iterator,o=(n,o)=>({[t](){return this},next(){let t=n.next();for(;!t.done;){const{value:e}=t;if(o(e))return{value:e,done:!1};t=n.next()}return t}}),e=n=>null!=n&&"function"==typeof n.then,r=Symbol.asyncIterator,u=(n,t)=>({isAsyncIteratorDone:!1,[r](){return this},async next(){for(;!this.isAsyncIteratorDone;){const{value:o,done:r}=await n.next();if(r)this.isAsyncIteratorDone=!0;else{const n=t(o);if(e(n)?await n:n)return{value:o,done:!1}}}return{value:void 0,done:!0}}}),c=Array.isArray,i=Object.prototype.toString,f=n=>i.call(n),s=function(t,o,e,r,u){return o==n?((n,t,o,e)=>function(r){return n(r,t,o,e)})(t,e,r,u):e==n?((n,t,o,e)=>function(r){return n(t,r,o,e)})(t,o,r,u):r==n?((n,t,o,e)=>function(r){return n(t,o,r,e)})(t,o,e,u):((n,t,o,e)=>function(r){return n(t,o,e,r)})(t,o,e,r)},l=Promise.all.bind(Promise),h=function(n,t,o,e){const r=t.length;let u=n.length-1;for(;++e<r;)n[++u]=o(t[e],e,n);return n},a=function(n,t,o,e){const r=n.length;let u=-1;for(;++o<r;)e[++u]&&t.push(n[o]);return t},y=function(t,o){const r=t.length,u=[];let c=-1,i=-1;for(;++c<r;){const r=t[c],f=o(r);if(e(f))return l(h([f],t,o,c)).then(s(a,t,u,c-1,n));f&&(u[++i]=r)}return u},p=function(t,o,e,r){return o==n?((n,t,o)=>function(e){return n(e,t,o)})(t,e,r):e==n?((n,t,o)=>function(e){return n(t,e,o)})(t,o,r):((n,t,o)=>function(e){return n(t,o,e)})(t,o,e)},d=(n,t,o)=>n?t():o(),g=n=>function(){return n},b=(n,t,o)=>n[t](o),j=(n,t)=>function(){return n(t)},v=function(){},m=(n,t,o,e,r)=>function(){return n(t,o,e,r)},w=(n,t,o,e)=>n[t](o,e),x=function(n,t,o,e){e&&(n[t]=o)},A=function(n,t,o,e){const r=t.length;let u=n.length-1;for(;++e<r;)n[++u]=o(t[e],e,t);return n},S=function(i,h){return c(i)?y(i,h):"function"==typeof i?(n=>"[object GeneratorFunction]"==f(n))(i)?((n,t)=>function*(...e){yield*o(n(...e),t)})(i,h):(n=>"[object AsyncGeneratorFunction]"==f(n))(i)?((n,t)=>async function*(...o){yield*u(n(...o),t)})(i,h):((t,o)=>function(r,u){const c=o(u);return e(c)?c.then(p(d,n,(i=t,f=r,s=u,function(){return i(f,s)}),g(r))):c?t(r,u):r;var i,f,s})(i,h):null==i?i:"string"==typeof i||i.constructor==String?function(t,o){const r=y(t,o);return e(r)?r.then(p(b,n,"join","")):r.join("")}(i,h):i.constructor==Set?function(t,o){const r=new Set,u=r.add.bind(r),c=[];for(const i of t){const f=o(i,i,t);e(f)?c.push(f.then(p(d,n,j(u,i),v))):f&&r.add(i)}return 0==c.length?r:l(c).then(g(r))}(i,h):i.constructor==Map?function(t,o){const r=new Map,u=[];for(const[c,i]of t){const f=o(i,c,t);e(f)?u.push(f.then(p(d,n,m(w,r,"set",c,i),v))):f&&r.set(c,i)}return 0==u.length?r:l(u).then(g(r))}(i,h):"function"==typeof i.filter?i.filter(h):"function"==typeof i[t]?o(i[t](),h):"function"==typeof i[r]?u(i[r](),h):i.constructor==Object?function(t,o){const r={},u=[];for(const c in t){const i=t[c],f=o(i,c,t);e(f)?u.push(f.then(s(x,r,c,t[c],n))):f&&(r[c]=i)}return 0==u.length?r:l(u).then(g(r))}(i,h):i},I=function(...t){const o=t.pop();return t.length>0?S(t[0],o):(e=S,u=o,(r=n)==n?((n,t)=>function(o){return n(o,t)})(e,u):((n,t)=>function(o){return n(t,o)})(e,r));var e,r,u};I.withIndex=t=>function(o){if(c(o))return function(t,o){const r=t.length,u=[];let c=-1,i=-1;for(;++c<r;){const r=t[c],f=o(r,c,t);if(e(f))return l(A([f],t,o,c)).then(s(a,t,u,c-1,n));f&&(u[++i]=r)}return u}(o,t);throw new TypeError(`${o} is not an Array`)};const D=n=>!n,O=function(n){return"function"==typeof n?function(t){const o=n(t);return e(o)?o.then(D):!o}:!n};O.sync=n=>function(...t){return!n(...t)};return n=>I(O(n))}());
