/**
 * rubico v2.6.1
 * https://github.com/a-synchronous/rubico
 * (c) 2019-2024 Richard Tong
 * rubico may be freely distributed under the MIT license.
 */

!function(n,t){for(const e in t)n[e]=t[e]}("object"==typeof globalThis?globalThis:this,function(){"use strict";const n=n=>null!=n&&"function"==typeof n.then,t=function(t){const e=t.length;let o=-1;for(;++o<e;){const e=t[o];if(n(e))return!0}return!1},e=Promise.all.bind(Promise),o=(t,e)=>function(...o){const r=t(...o);return n(r)?r.then(e):e(r)},r=(n,t)=>n(...t),u=Symbol.for("placeholder"),c=function(n,t,e){return t==u?((n,t)=>function(e){return n(e,t)})(n,e):((n,t)=>function(e){return n(t,e)})(n,t)},f=n=>function(){return n},i=(n,t)=>function(){return n(...t)},s=(n,t,e)=>n?t():e(),l=function(n,t,e,o){return t==u?((n,t,e)=>function(o){return n(o,t,e)})(n,e,o):e==u?((n,t,e)=>function(o){return n(t,o,e)})(n,t,o):((n,t,e)=>function(o){return n(t,e,o)})(n,t,e)},h=function(n,t,e){return t==u?((n,t)=>function(...e){return n(e,t)})(n,e):((n,t)=>function(...e){return n(t,e)})(n,t)},a=function(n,t,e,o){return t==u?((n,t,e)=>function(...o){return n(o,t,e)})(n,e,o):e==u?((n,t,e)=>function(...o){return n(t,o,e)})(n,t,o):((n,t,e)=>function(...o){return n(t,e,o)})(n,t,e)},p=function(t,e){const o=t[0],r=e(...t);return n(r)?r.then(f(o)):o},d=function(...n){const o=n.pop();return 0==n.length?h(p,u,o):t(n)?e(n).then(c(p,u,o)):p(n,o)},y=function(t,e,o){const r=t(...o);if(n(r))return r.then(l(s,u,i(d(e),o),f(o[0])));if(r){const t=e(...o);if(n(t))return t.then(f(o[0]))}return o[0]};d.if=function(...n){if(2==n.length)return a(y,n[0],n[1],u);const o=n.length,r=n[o-1],c=n[o-2],f=n.slice(0,-2);return t(f)?e(f).then(l(y,c,r,u)):y(c,r,n)};const g=Array.isArray,w=function(t,o){const r=t.length,u=Array(r);let c=-1,f=!1;for(;++c<r;){const e=t[c](...o);n(e)&&(f=!0),u[c]=e}return f?e(u):u},v=function(n,t,e,o,r){return t==u?((n,t,e,o)=>function(r){return n(r,t,e,o)})(n,e,o,r):e==u?((n,t,e,o)=>function(r){return n(t,r,e,o)})(n,t,o,r):o==u?((n,t,e,o)=>function(r){return n(t,e,r,o)})(n,t,e,r):((n,t,e,o)=>function(r){return n(t,e,o,r)})(n,t,e,o)},x=function(n,t,e){return n[t]=e,n},j=async function(t,e,o,r){const u=t.length;for(;++r<u;){const u=t[r](...e);o[r]=n(u)?await u:u}return o},b=function(t,e){const r=t.length,c=[];let f=-1;for(;++f<r;){const r=t[f](...e);if(n(r))return r.then(o(l(x,c,f,u),v(j,t,e,u,f)));c[f]=r}return c},S=function(t,o){const r={},c=[];for(const e in t){const f=t[e](...o);n(f)?c.push(f.then(l(x,r,e,u))):r[e]=f}return 0==c.length?r:e(c).then(f(r))},M=function(...n){const o=n.pop();return 0==n.length?g(o)?h(w,o,u):h(S,o,u):t(n)?g(o)?e(n).then(c(w,o,u)):e(n).then(c(S,o,u)):g(o)?w(o,n):S(o,n)};M.series=function(...n){const o=n.pop();return 0==n.length?h(b,o,u):t(n)?e(n).then(c(b,o,u)):b(o,n)};const O=Object.assign,m=function(t,e){const o=S(e,[t]);return n(o)?o.then(l(O,{},t,u)):{...t,...o}},z=function(n,t,e){return n(t,...e)},A=function(t,e,o){try{const r=t(...o);return n(r)?r.catch(l(z,e,u,o)):r}catch(n){return e(n,...o)}},E=(n,t,e,o)=>function(){return n(t,e,o)},T=function(t,e,o){const r=t.length-1;for(;(o+=2)<r;){const r=t[o],c=t[o+1],h="function"==typeof r?r(...e):r;if(n(h))return h.then(l(s,u,"function"==typeof c?i(c,e):f(c),E(T,t,e,o)));if(h)return"function"==typeof c?c(...e):c}if(o==t.length)return;const c=t[r];return"function"==typeof c?c(...e):c},I=function(n){const t=n.length;let e=-1;for(;++e<t;)if("function"==typeof n[e])return!1;return!0},D=(n,t,e)=>function(){return n(t,e)},P=function(t,e){const o=t.length,r=o-1;for(;(e+=2)<r;){const o=t[e],r=t[e+1];if(n(o))return o.then(l(s,u,f(r),D(P,t,e)));if(o)return r}if(e!=o)return t[e]},B=Symbol.iterator,$=(n,t)=>({toString:()=>"[object MappingIterator]",[B](){return this},next(){const e=n.next();return e.done?e:{value:t(e.value),done:!1}}}),k=n=>({value:n,done:!1}),C=Symbol.asyncIterator,_=(t,e)=>({[C](){return this},async next(){const o=await t.next();if(o.done)return o;const r=e(o.value);return n(r)?r.then(k):{value:r,done:!1}}}),q=function(t,o){const r=t.length,u=Array(r);let c=-1,f=!1;for(;++c<r;){const e=o(t[c],c,t);n(e)&&(f=!0),u[c]=e}return f?e(u):u},F=(n,t,e)=>n[t](e),R=function(t,o){const r=new Set,c=[];for(const e of t){const f=o(e,e,t);n(f)?c.push(f.then(l(F,r,"add",u))):r.add(f)}return 0==c.length?r:e(c).then(f(r))},V=(n,t,e,o)=>n[t](e,o),G=t=>new Promise((t=>function(e){const o={};let r=0;for(const u in t){const c=t[u];n(c)?(r+=1,c.then((n=>function(t){o[n]=t,r-=1,0==r&&e(o)})(u))):o[u]=c}0==r&&e(o)})(t)),H=function(t,e){const o={};let r=!1;for(const u in t){const c=e(t[u],u,t);n(c)&&(r=!0),o[u]=c}return r?G(o):o},J=async function(t,e,o,r){const u=t.length;for(;++r<u;){const u=e(t[r],r);o[r]=n(u)?await u:u}return o},K=function(t,e){const r=t.length,c=Array(r);let f=-1;for(;++f<r;){const r=e(t[f],f);if(n(r))return r.then(o(l(x,c,f,u),v(J,t,e,u,f)));c[f]=r}return c},L=(n,t,e,o,r)=>function(){return n(t,e,o,r)},N=async function(t,e,o,r){for(const u in t){if(u in r)continue;let c=e(t[u]);n(c)&&(c=await c),o[u]=c}return o},Q=function(n,t){return n.add(t),n},U=async function(t,e,o){let r=t.next();for(;!r.done;){let u=e(r.value);n(u)&&(u=await u),o.add(u),r=t.next()}return o},W=function(n,t,e){return n.set(t,e)},X=async function(t,e,o){let r=t.next();for(;!r.done;){let u=e(r.value[1]);n(u)&&(u=await u),o.set(r.value[0],u),r=t.next()}return o},Y=n=>function(...t){return n(...t),t[0]},Z=Promise.race.bind(Promise),nn=async function(t,o,r,u,c,f){const i=t.length;for(;++c<i;){f.size>=r&&await Z(f);const e=o(t[c]);if(n(e)){const n=e.then(Y((()=>f.delete(n))));f.add(n),u[c]=n}else u[c]=e}return e(u)},tn=function(t,e,o){const r=t.length,u=Array(r);let c=-1;for(;++c<r;){const r=o(t[c]);if(n(r)){const n=new Set,f=r.then(Y((()=>n.delete(f))));return n.add(f),u[c]=f,nn(t,o,e,u,c,n)}u[c]=r}return u},en=async function(t,o,r,u,c,f){let i=o.next();for(;!i.done;){f.size>=r&&await Z(f);const e=u(i.value,i.value,t);if(n(e)){const n=e.then((t=>{f.delete(n),c.add(t)}));f.add(n)}else c.add(e);i=o.next()}return f.size>0&&await e(f),c},on=async function(t,o,r,u,c,f){let i=o.next();for(;!i.done;){f.size>=r&&await Z(f);const e=i.value[0],s=u(i.value[1],e,t);if(n(s)){c.set(e,s);const n=s.then((t=>{f.delete(n),c.set(e,t)}));f.add(n)}else c.set(e,s);i=o.next()}return f.size>0&&await e(f),c},rn=async function(t,o,r,u,c,f){for(const e in t){if(e in c)continue;f.size>=o&&await Z(f);const i=r(t[e],e,t);if(n(i)){u[e]=i;const n=i.then((t=>{f.delete(n),u[e]=t}));f.add(n)}else u[e]=i}return f.size>0&&await e(f),u},un=(n,t,e)=>function(...o){const r=e.length,c=o.length,f=[];let i=-1,s=-1,l=0;for(;++i<r;){const r=e[i];if(r==u&&(s+=1)<c){const n=o[s];n==u&&(l+=1),f.push(n)}else f.push(r);if(f.length==n)return 0==l?t(...f):cn(n,t,f)}for(;++s<c;){const e=o[s];if(e==u&&(l+=1),f.push(e),f.length==n)return 0==l?t(...f):cn(n,t,f)}return cn(n,t,f)},cn=function(n,t,e){const o=e.length;if(o<n)return un(n,t,e);let r=-1;for(;++r<o;){if(e[r]==u)return un(n,t,e)}return t(...e)},fn=n=>function([t,e]){return n(t,e)},sn=function(t,o){const r=new Map,u=[];return t.forEach(((t,e,o)=>function(r,u){const c=t([u,r]);n(c)?o.push(c.then(fn(cn(3,W,[e])))):e.set(c[0],c[1])})(o,r,u)),0==u.length?r:e(u).then(f(r))},ln=function(t,o){return g(t)?q(t,o):null==t?t:"function"==typeof t.then?t.then(o):"function"==typeof t.map?t.map(o):"string"==typeof t||t.constructor==String?function(t,e){const o=q(t,e);return n(o)?o.then(l(F,u,"join","")):o.join("")}(t,o):t.constructor==Set?R(t,o):t.constructor==Map?function(t,o){const r=new Map,c=[];for(const[e,f]of t){const i=o(f,e,t);n(i)?c.push(i.then(v(V,r,"set",e,u))):r.set(e,i)}return 0==c.length?r:e(c).then(f(r))}(t,o):"function"==typeof t[B]?$(t[B](),o):"function"==typeof t[C]?_(t[C](),o):t.constructor==Object?H(t,o):o(t)},hn=function(t,e){return null==e?c(ln,u,t):n(t)?t.then(c(ln,u,e)):ln(t,e)},an=(t,o)=>{if(null==t)throw new TypeError("value is not an Object or Map");if(t.constructor==Object)return function(t,o){const r={},u=[];for(const e in t){const c=o([e,t[e]]);n(c)?u.push(c.then(fn(cn(3,x,[r])))):r[c[0]]=c[1]}return 0==u.length?r:e(u).then(f(r))}(t,o);if(t.constructor==Map)return sn(t,o);throw new TypeError("value is not an Object or Map")};hn.entries=function(t,e){return null==e?c(an,u,t):n(t)?t.then(c(an,u,e)):an(t,e)};const pn=function(t,e){if(g(t))return K(t,e);if(null==t)throw new TypeError(`invalid collection ${t}`);if("string"==typeof t||t.constructor==String)return function(t,e){const o=K(t,e);return n(o)?o.then(l(F,u,"join","")):o.join("")}(t,e);if(t.constructor==Set)return function(t,e){const r=new Set,f=t[B]();let i=f.next();for(;!i.done;){const t=e(i.value);if(n(t))return t.then(o(c(Q,r,u),E(U,f,e,r)));r.add(t),i=f.next()}return r}(t,e);if(t.constructor==Map)return function(t,e){const r=new Map,c=t[B]();let f=c.next();for(;!f.done;){const t=f.value[0],i=e(f.value[1]);if(n(i))return i.then(o(l(W,r,t,u),E(X,c,e,r)));r.set(t,i),f=c.next()}return r}(t,e);if(t.constructor==Object)return function(t,e){const r={},c={};for(const f in t){c[f]=!0;const i=e(t[f],f,t);if(n(i))return i.then(o(l(x,r,f,u),L(N,t,e,r,c)));r[f]=i}return r}(t,e);throw new TypeError(`invalid collection ${t}`)};hn.series=function(t,e){return null==e?c(pn,u,t):n(t)?t.then(c(pn,u,e)):pn(t,e)};const dn=function(t,e,o){if(g(t))return tn(t,e,o);if(null==t)throw new TypeError(`invalid collection ${t}`);if("string"==typeof t||t.constructor==String)return function(t,e,o){const r=tn(t,e,o);return n(r)?r.then(l(F,u,"join","")):r.join("")}(t,e,o);if(t.constructor==Set)return function(t,e,o){const r=new Set,u=t[B]();let c=u.next();for(;!c.done;){const f=o(c.value,c.value,t);if(n(f)){const n=new Set,c=f.then((t=>{n.delete(c),r.add(t)}));return n.add(c),en(t,u,e,o,r,n)}r.add(f),c=u.next()}return r}(t,e,o);if(t.constructor==Map)return function(t,e,o){const r=new Map,u=t[B]();let c=u.next();for(;!c.done;){const f=c.value[0],i=o(c.value[1],f,t);if(n(i)){const n=new Set;r.set(f,i);const c=i.then((t=>{n.delete(c),r.set(f,t)}));return n.add(c),on(t,u,e,o,r,n)}r.set(f,i),c=u.next()}return r}(t,e,o);if(t.constructor==Object)return function(t,e,o){const r={},u={};for(const c in t){u[c]=!0;const f=o(t[c],c,t);if(n(f)){const n=new Set;r[c]=f;const i=f.then((t=>{n.delete(i),r[c]=t}));return n.add(i),rn(t,e,o,r,u,n)}r[c]=f}return r}(t,e,o);throw new TypeError(`invalid collection ${t}`)};hn.pool=function(t,e,o){return null==o?l(dn,u,t,e):n(t)?t.then(l(dn,u,e,o)):dn(t,e,o)};const yn=(n,t)=>({[B](){return this},next(){let e=n.next();for(;!e.done;){const{value:o}=e;if(t(o))return{value:o,done:!1};e=n.next()}return e}}),gn=(t,e)=>({isAsyncIteratorDone:!1,[C](){return this},async next(){for(;!this.isAsyncIteratorDone;){const{value:o,done:r}=await t.next();if(r)this.isAsyncIteratorDone=!0;else{const t=e(o);if(n(t)?await t:t)return{value:o,done:!1}}}return{value:void 0,done:!0}}}),wn=function(n,t,e,o){const r=t.length;let u=n.length-1;for(;++o<r;)n[++u]=e(t[o],o,n);return n},vn=function(n,t,e,o){const r=n.length;let u=-1;for(;++e<r;)o[++u]&&t.push(n[e]);return t},xn=function(t,o){const r=t.length,c=[];let f=-1,i=-1;for(;++f<r;){const r=t[f],s=o(r,f,t);if(n(s))return e(wn([s],t,o,f)).then(v(vn,t,c,f-1,u));s&&(c[++i]=r)}return c},jn=(n,t)=>function(){return n(t)},bn=function(){},Sn=function(n,t,e,o){o&&(n[t]=e)},Mn=function(t,o){return g(t)?xn(t,o):null==t?t:"string"==typeof t||t.constructor==String?function(t,e){const o=xn(t,e);return n(o)?o.then(l(F,u,"join","")):o.join("")}(t,o):t.constructor==Set?function(t,o){const r=new Set,c=r.add.bind(r),i=[];for(const e of t){const f=o(e,e,t);n(f)?i.push(f.then(l(s,u,jn(c,e),bn))):f&&r.add(e)}return 0==i.length?r:e(i).then(f(r))}(t,o):t.constructor==Map?function(t,o){const r=new Map,c=[];for(const[e,f]of t){const i=o(f,e,t);n(i)?c.push(i.then(l(s,u,L(V,r,"set",e,f),bn))):i&&r.set(e,f)}return 0==c.length?r:e(c).then(f(r))}(t,o):"function"==typeof t.filter?t.filter(o):"function"==typeof t[B]?yn(t[B](),o):"function"==typeof t[C]?gn(t[C](),o):t.constructor==Object?function(t,o){const r={},c=[];for(const e in t){const f=t[e],i=o(f,e,t);n(i)?c.push(i.then(v(Sn,r,e,t[e],u))):i&&(r[e]=f)}return 0==c.length?r:e(c).then(f(r))}(t,o):t},On=Object.values,mn=(Object.prototype.toString,async function(t,e,o){let r=t.next();if(r.done)return o;for(;!r.done;)o=e(o,r.value),n(o)&&(o=await o),r=t.next();return o}),zn=async function(t,e,o,r){const u=t.length;for(;++r<u;)o=e(o,t[r],r,t),n(o)&&(o=await o);return o},An=Object.keys,En=async function(t,e,o,r,u){const c=r.length;for(;++u<c;){const c=r[u];o=e(o,t[c],c,t),n(o)&&(o=await o)}return o},Tn=async function(t,e,o,r){for(const[u,c]of r)o=e(o,c,u,t),n(o)&&(o=await o);return o},In=function(t,e,o){return g(t)?function(t,e,o){const r=t.length;let c=-1;for(void 0===o&&(o=t[++c]);++c<r;)if(o=e(o,t[c],c,t),n(o))return o.then(v(zn,t,e,u,c));return o}(t,e,o):null==t?void 0===o?c(e,t,u):e(o,t):t.constructor==Map?function(t,e,o){const r=t.entries();if(void 0===o){const n=r.next();if(n.done)return o;o=n.value[1]}for(const[c,f]of r)if(o=e(o,f,c,t),n(o))return o.then(v(Tn,t,e,u,r));return o}(t,e,o):"function"==typeof t[B]?function(t,e,o){let r=t.next();if(r.done)return o;for(void 0===o&&(o=r.value,r=t.next());!r.done;){if(o=e(o,r.value),n(o))return o.then(l(mn,t,e,u));r=t.next()}return o}(t[B](),e,o):"function"==typeof t[C]?async function(n,t,e){let o=await n.next();if(o.done)return e;for(void 0===e&&(e=o.value,o=await n.next());!o.done;)e=await t(e,o.value),o=await n.next();return e}(t[C](),e,o):"function"==typeof t.reduce?t.reduce(e,o):"function"==typeof t.chain?t.chain(c(e,o,u)):"function"==typeof t.flatMap?t.flatMap(c(e,o,u)):t.constructor==Object?function(t,e,o){const r=An(t),c=r.length;let f=-1;for(void 0===o&&(o=t[r[++f]]);++f<c;){const c=r[f];if(o=e(o,t[c],c,t),n(o))return o.then((i=En,l=e,h=u,a=r,p=f,(s=t)==u?((n,t,e,o,r)=>function(u){return n(u,t,e,o,r)})(i,l,h,a,p):l==u?((n,t,e,o,r)=>function(u){return n(t,u,e,o,r)})(i,s,h,a,p):h==u?((n,t,e,o,r)=>function(u){return n(t,e,u,o,r)})(i,s,l,a,p):a==u?((n,t,e,o,r)=>function(u){return n(t,e,o,u,r)})(i,s,l,h,p):((n,t,e,o,r)=>function(u){return n(t,e,o,r,u)})(i,s,l,h,a)))}var i,s,l,h,a,p;return o}(t,e,o):void 0===o?c(e,t,u):e(o,t)},Dn=function(t,e,o){if("function"==typeof o){const r=o(t);return n(r)?r.then(l(In,t,e,u)):In(t,e,r)}return n(o)?o.then(l(In,t,e,u)):In(t,e,o)},Pn=ArrayBuffer.isView,Bn=function(n,t){return g(t)||Pn(t)?function(n,t){const e=n.length,o=t.length;let r=-1;for(;++r<o;)n[e+r]=t[r];return n}(n,t):(n.push(t),n)},$n="function"==typeof Buffer,kn=$n?Buffer.alloc:bn,Cn=function(n,t){const e=n.length,o=$n&&n.constructor==Buffer?kn(e+t.length):new n.constructor(e+t.length);return o.set(n),o.set(t,e),o},_n=function(n,t){return g(t)||Pn(t)?Cn(n,t):Cn(n,[t])},qn=(n,t)=>new Promise(((n,t)=>function(e,o){t.on("data",(n=>function(t,e,o){return n.write(t,e,o),n})(n)),t.on("end",jn(e,n)),t.on("error",o)})(n,t)),Fn=function(n,t){return null!=(e=t)&&"function"==typeof e.pipe?qn(n,t):(n.write(t),n);var e},Rn=function(n,t){if(null!=t&&t.constructor==Set){for(const e of t)n.add(e);return n}return n.add(t)},Vn=function(n,t){return n.concat(t)},Gn=function(t,e,o){const r=In(t,e(bn),null);return n(r)?r.then(f(o)):o},Hn=function(t,e,o){if(g(o))return In(t,e(Bn),o);if(Pn(o)){const r=In(t,e(Bn),[]);return n(r)?r.then(c(_n,o,u)):_n(o,r)}if(null==o)return Gn(t,e,o);const r=o.constructor;if("string"==typeof o||r==String){const r=In(t,e(Bn),[o]);return n(r)?r.then(l(F,u,"join","")):r.join("")}return"function"==typeof o.concat?In(t,e(Vn),o):"function"==typeof o.write?In(t,e(Fn),o):r==Set?In(t,e(Rn),o):r==Object?In(t,e(O),o):Gn(t,e,o)},Jn=function(t,e,o){if("function"==typeof o){const r=o(t);return n(r)?r.then(l(Hn,t,e,u)):Hn(t,e,r)}return n(o)?o.then(l(Hn,t,e,u)):Hn(t,e,o)},Kn=function(n,t){return n.push(t),n},Ln=n=>new Promise((t=>{setTimeout(t,n)})),Nn=(n,t)=>t,Qn=n=>n,Un=(n,t)=>function(...e){return t(n(...e))},Wn=async function(t,o){const r=[];for await(const e of t){const t=o(e);n(t)&&r.push(t)}return 0==r.length?t:e(r).then(f(t))},Xn=function(t){const o=t.length,r=[],i=[];let s=-1;for(;++s<o;){const e=t[s];if(g(e)){const n=e.length;let t=-1;for(;++t<n;)i.push(e[t])}else if(null==e)i.push(e);else if("function"==typeof e.then)r.push(e.then(c(Kn,i,u)));else if("function"==typeof e[B])for(const n of e)i.push(n);else if("function"==typeof e[C])r.push(Wn(e[C](),c(Kn,i,u)));else if("function"==typeof e.chain){const t=e.chain(Qn);n(t)?r.push(t.then(c(Kn,i,u))):i.push(t)}else if("function"==typeof e.flatMap){const t=e.flatMap(Qn);n(t)?r.push(t.then(c(Kn,i,u))):i.push(t)}else if("function"==typeof e.reduce){const t=e.reduce(Un(Nn,c(Kn,i,u)),null);n(t)&&r.push(t)}else if(e.constructor==Object)for(const n in e)i.push(e[n]);else i.push(e)}return 0==r.length?i:e(r).then(f(i))},Yn=function(t){const o=[],r={},f=c(O,r,u),i=Un(Nn,f);for(const e in t){const u=t[e];if(null!=u)if("function"==typeof u[B])for(const n of u)O(r,n);else if("function"==typeof u[C])o.push(Wn(u[C](),f));else if("function"==typeof u.chain){const t=u.chain(Qn);n(t)?o.push(t.then(f)):O(r,t)}else if("function"==typeof u.flatMap){const t=u.flatMap(Qn);n(t)?o.push(t.then(f)):f(t)}else if("function"==typeof u.reduce){const t=u.reduce(i,null);n(t)&&o.push(t)}else O(r,u)}return 0==o.length?r:e(o).then((()=>r))},Zn=function(t){t.size;const o=[],r=new Set,c=(n,t)=>r.add(t),f=l(F,r,"add",u);for(const e of t)if(g(e)){const n=e.length;let t=-1;for(;++t<n;)r.add(e[t])}else if(null==e)r.add(e);else if("function"==typeof e[B])for(const n of e)r.add(n);else if("function"==typeof e[C])o.push(Wn(e[C](),f));else if("function"==typeof e.chain){const t=e.chain(Qn);n(t)?o.push(t.then(f)):r.add(t)}else if("function"==typeof e.flatMap){const t=e.flatMap(Qn);n(t)?o.push(t.then(f)):r.add(t)}else if("function"==typeof e.reduce){const t=e.reduce(c,null);n(t)&&o.push(t)}else if(e.constructor==Object)for(const n in e)r.add(e[n]);else r.add(e);return 0==o.length?r:e(o).then((()=>r))},nt=o(Xn,c(((n,t)=>n.join(t)),u,"")),tt=function(t,e){if(g(t))return function(t,e){const o=q(t,e);return n(o)?o.then(Xn):Xn(o)}(t,e);if(null==t)return e(t);if("function"==typeof t.then)return t.then(e);if("function"==typeof t.next)return B in t?function(n,t){let e=[],o=0;return{[B](){return this},next(){if(o<e.length){const n=e[o];return o+=1,{value:n,done:!1}}const r=n.next();if(r.done)return r;const u=In(t(r.value),Kn,[]);return u.length>1&&(e=u,o=1),{value:u[0],done:!1}}}}(t,e):function(t,e){const o=[],r=new Set;return{isAsyncIteratorDone:!1,[C](){return this},toString:()=>"[object FlatMappingAsyncIterator]",async next(){for(;!this.isAsyncIteratorDone||o.length>0||r.size>0;){if(!this.isAsyncIteratorDone){const{value:c,done:f}=await t.next();if(f)this.isAsyncIteratorDone=f;else{const t=e(c);if(n(t)){const n=t.then(l(In,u,Kn,o)).then((()=>r.delete(n)));r.add(n)}else{const e=In(t,Kn,o);if(n(e)){const n=e.then((()=>r.delete(n)));r.add(n)}}}}if(o.length>0)return{value:o.shift(),done:!1};r.size>0&&await Z([Ln(1e3),...r])}return{value:void 0,done:!0}}}}(t,e);if("function"==typeof t.chain)return t.chain(e);if("function"==typeof t.flatMap)return t.flatMap(e);const o=t.constructor;return o==Object?function(t,e){const o=H(t,e);return n(o)?o.then(Yn):Yn(o)}(t,e):o==Set?function(t,e){const o=R(t,e);return n(o)?o.then(Zn):Zn(o)}(t,e):"string"==typeof t||o==String?function(t,e){const o=q(t,e);return n(o)?o.then(nt):nt(o)}(t,e):e(t)},et=async function(t,e,o){const r=t.length;for(;++o<r;){const r=e(t[o]);n(r)&&await r}return t},ot=async function(t,e,o){for(const r in t){if(r in o)continue;const u=e(t[r]);n(u)&&await u}return t},rt=async function(t,e){let o=t.next();for(;!o.done;){const r=e(o.value);n(r)&&await r,o=t.next()}return t},ut=function(t,o){return g(t)?function(t,o){const r=t.length,u=[];let c=-1;for(;++c<r;){const e=o(t[c]);n(e)&&u.push(e)}return 0==u.length?t:e(u).then(f(t))}(t,o):null==t?t:"function"==typeof t.forEach?(t.forEach(o),t):"function"==typeof t[B]?function(t,o){const r=[];for(const e of t){const t=o(e);n(t)&&r.push(t)}return 0==r.length?t:e(r).then(f(t))}(t[B](),o):"function"==typeof t[C]?Wn(t[C](),o):t.constructor==Object?function(t,o){const r=[];for(const e in t){const u=o(t[e]);n(u)&&r.push(u)}return 0==r.length?t:e(r).then(f(t))}(t,o):t},ct=function(t,e){return"function"==typeof t?c(ut,u,t):n(t)?t.then(c(ut,u,e)):ut(t,e)},ft=function(t,e){if(g(t))return function(t,e){const o=t.length;let r=-1;for(;++r<o;){const o=e(t[r]);if(n(o))return o.then(E(et,t,e,r))}return t}(t,e);if(null==t)throw new TypeError(`invalid collection ${t}`);if("function"==typeof t[B])return function(t,e){let o=t.next();for(;!t.done;){const r=e(o.value);if(n(r))return r.then(D(rt,t,e));o=t.next()}return t}(t[B](),e);if("function"==typeof t[C])return async function(t,e){for await(const o of t){const t=e(o);n(t)&&await t}return t}(t[C](),e);if(t.constructor==Object)return function(t,e){const o={};for(const r in t){o[r]=!0;const u=e(t[r]);if(n(u))return u.then(E(ot,t,e,o))}return t}(t,e);throw new TypeError(`invalid collection ${t}`)};ct.series=function(t,e){return"function"==typeof t?c(ft,u,t):n(t)?t.then(c(ft,u,e)):ft(t,e)};const it=function(n){const t=n.then((n=>[n,t]));return t},st=async function(t,e,o,r){const u=t.length;for(;++o<u;){const u=e(t[o]);if(n(u))r.add(it(u));else if(u)return!0}for(;r.size>0;){const[n,t]=await Z(r);if(r.delete(t),n)return!0}return!1},lt=function(t,e){const o=t.length;let r=-1;for(;++r<o;){const o=e(t[r]);if(n(o))return st(t,e,r,new Set([it(o)]));if(o)return!0}return!1},ht=async function(t,e,o,r=20){let u=t.next();for(n(u)&&(u=await u);!u.done;){if(o.size>=r){const[n,t]=await Z(o);if(o.delete(t),n)return!0}const c=e(u.value);if(n(c))o.add(it(c));else if(c)return!0;u=t.next(),n(u)&&(u=await u)}for(;o.size>0;){const[n,t]=await Z(o);if(o.delete(t),n)return!0}return!1},at=function(t,e){return g(t)?lt(t,e):null==t?e(t):"function"==typeof t[B]?function(t,e){for(const o of t){const r=e(o);if(n(r))return ht(t,e,new Set([it(r)]));if(r)return!0}return!1}(t[B](),e):"function"==typeof t[C]?ht(t[C](),e,new Set):"function"==typeof t.reduce?t.reduce((t=>function(e,o){return!0===e?e:n(e)?e.then(c((n=>function(t,e){return!!t||n(e)})(t),u,o)):!!e||t(o)})(e),!1):t.constructor==Object?lt(On(t),e):e(t)},pt=function(t,o){const r=t.length,c=[];let f=-1;for(;++f<r;){const e=o(t[f]);if(n(e))c.push(e);else if(!e)return!1}return 0==c.length||e(c).then(l(F,u,"every",Boolean))},dt=(n,t,e)=>!!t&&n(e),yt=function(t,o){return g(t)?pt(t,o):null==t?o(t):"function"==typeof t[B]?function(t,o){const r=[];for(const e of t){const t=o(e);if(n(t))r.push(t);else if(!t)return!1}return 0==r.length||e(r).then(l(F,u,"every",Boolean))}(t[B](),o):"function"==typeof t[C]?async function(t,e,o,r=20){let u=await t.next();for(;!u.done;){if(o.size>=r){const[n,t]=await Z(o);if(o.delete(t),!n)return!1}const c=e(u.value);if(n(c))o.add(it(c));else if(!c)return!1;u=await t.next()}for(;o.size>0;){const[n,t]=await Z(o);if(o.delete(t),!n)return!1}return!0}(t[C](),o,new Set):"function"==typeof t.reduce?t.reduce((t=>function(e,o){return!1!==e&&(n(e)?e.then(l(dt,t,u,o)):!!e&&t(o))})(o),!0):t.constructor==Object?pt(On(t),o):o(t)},gt=function(t,e){const o=t.length;for(;++e<o;){const o=t[e];if(n(o))return o.then(l(s,u,D(gt,t,e),f(!1)));if(!o)return!1}return!0},wt=async function(t,e,o){const r=e.length;for(;++o<r;){let r=e[o];if("function"==typeof r&&(r=r(...t)),n(r)&&(r=await r),!r)return!1}return!0},vt=function(t,e){const o=e.length;let r=-1;for(;++r<o;){let o=e[r];if("function"==typeof o&&(o=o(...t)),n(o))return o.then(l(s,u,E(wt,t,e,r),f(!1)));if(!o)return!1}return!0},xt=function(t,e){const o=t.length;for(;++e<o;){const o=t[e];if(n(o))return o.then(l(s,u,f(!0),D(xt,t,e)));if(o)return!0}return!1},jt=async function(t,e,o){const r=e.length;for(;++o<r;){let r=e[o];if("function"==typeof r&&(r=r(...t)),n(r)&&(r=await r),r)return!0}return!1},bt=function(t,e){const o=e.length;let r=-1;for(;++r<o;){let o=e[r];if("function"==typeof o&&(o=o(...t)),n(o))return o.then(l(s,u,f(!0),E(jt,t,e,r)));if(o)return!0}return!1},St=n=>!n,Mt=function(t,e){const o=e(...t);return n(o)?o.then(St):!o},Ot=function(n,t,e,o,r){return t==u?((n,t,e,o)=>function(...r){return n(r,t,e,o)})(n,e,o,r):e==u?((n,t,e,o)=>function(...r){return n(t,r,e,o)})(n,t,o,r):o==u?((n,t,e,o)=>function(...r){return n(t,e,r,o)})(n,t,e,r):((n,t,e,o)=>function(...r){return n(t,e,o,r)})(n,t,e,o)},mt=function(t,o,r,u){const c=r(...t),f=u(...t);return n(c)||n(f)?e([c,f]).then(fn(o)):o(c,f)},zt=function(t,o,r,u){const c=r(...t);return n(c)||n(u)?e([c,u]).then(fn(o)):o(c,u)},At=function(t,o,r,u){const c=u(...t);return n(r)||n(c)?e([r,c]).then(fn(o)):o(r,c)},Et=o=>function(...r){const c=r.pop(),f=r.pop(),i="function"==typeof f,s="function"==typeof c;return i&&s?0==r.length?Ot(mt,u,o,f,c):t(r)?e(r).then(v(mt,u,o,f,c)):mt(r,o,f,c):i?0==r.length?Ot(zt,u,o,f,c):t(r)?e(r).then(v(zt,u,o,f,c)):zt(r,o,f,c):s?0==r.length?Ot(At,u,o,f,c):t(r)?e(r).then(v(At,u,o,f,c)):At(r,o,f,c):n(f)||n(c)?e([f,c]).then(fn(o)):o(f,c)},Tt=Et((function(n,t){return n==t})),It=Et(((n,t)=>n>t)),Dt=Et(((n,t)=>n<t)),Pt=Et(((n,t)=>n>=t)),Bt=Et(((n,t)=>n<=t)),$t=/[.|[|\]]+/,kt=function(n,t){const e=new Map,o=function(o){if(e.has(o))return e.get(o);const r=n(o);return e.set(o,r),e.size>t&&e.clear(),r};return o.cache=e,o}((function(n){const t=n.length-1,e="["==n[0],o="]"==n[t];return e&&o?n.slice(1,t).split($t):e?n.slice(1).split($t):o?n.slice(0,t).split($t):n.split($t)}),500),Ct=n=>g(n)?n:"string"==typeof n?kt(n):[n],_t=function(n,t){const e=Ct(t),o=e.length;let r=-1,u=n;for(;++r<o;)if(u=u[e[r]],null==u)return;return u},qt=function(n,t,e){const o=null==n?void 0:_t(n,t);return void 0===o?"function"==typeof e?e(n):e:o},Ft=function(n,t,e){if(!(n=>{if(null==n)return!1;const t=typeof n;return"object"==t||"function"==t})(n))return n;const o=Ct(e),r=o.length,u=r-1,c={...n};let f=c,i=-1;for(;++i<r;){const n=o[i];if(i==u)f[n]=t;else{const t=f[n],e=g(t)?t.slice():{...t};f[n]=e,f=e}}return c},Rt=function(t,e,o){if("function"==typeof o){const r=o(t);return n(r)?r.then(l(Ft,t,u,e)):Ft(t,r,e)}return n(o)?o.then(l(Ft,t,u,e)):Ft(t,o,e)},Vt=function(n,t){if(null==n)return n;const e=t.length;let o={},r=-1;for(;++r<e;){const e=t[r],u=_t(n,e);null!=u&&(o=Ft(o,u,e))}return o},Gt=function(n,t){if(null==n)return;const e=Ct(t),o=e.length-1;let r=-1,u=n;for(;++r<o;)if(u=u[e[r]],null==u)return;const c=e[r];null!=u&&c in u&&delete u[c]},Ht=function(n){const t={};for(const e in n){const o=n[e];g(o)?t[e]=Jt(o):null!=o&&o.constructor==Object?t[e]=Ht(o):t[e]=o}return t},Jt=function(n){const t=n.length,e=[];let o=-1;for(;++o<t;){const t=n[o];g(t)?e[o]=Jt(t):null!=t&&t.constructor==Object?e[o]=Ht(t):e[o]=t}return e},Kt=function(n,t){const e=t.length,o=g(r=n)?Jt(r):null==r?r:r.constructor==Object?Ht(r):r;var r;let u=-1;for(;++u<e;)Gt(o,t[u]);return o},Lt=(n,...t)=>cn(n.length,n,t);Lt.arity=function(n,t,...e){return cn(n,t,e)};return{pipe:function(...n){const f=n.pop().reduce(o);return 0==n.length?f:t(n)?e(n).then(c(r,f,u)):f(...n)},compose:function(...n){const f=n.pop().reduceRight(o);return 0==n.length?f:t(n)?e(n).then(c(r,f,u)):f(...n)},tap:d,forEach:ct,switchCase:(...n)=>{const o=n.pop();return I(o)?P(o,-2):0==n.length?a(T,o,u,-2):t(n)?e(n).then(l(T,o,u,-2)):T(o,n,-2)},tryCatch:function(...n){if(n.length>2){const o=n.pop(),r=n.pop();return t(n)?e(n).then(l(A,r,o,u)):A(r,o,n)}const o=n[0],r=n[1];return function(...n){return A(o,r,n)}},all:M,assign:function(t,e){return null==e?c(m,u,t):n(t)?t.then(c(m,u,e)):m(t,e)},get:function(t,e,o){return"string"==typeof t||"number"==typeof t||g(t)?l(qt,u,t,e):n(t)?t.then(l(qt,u,e,o)):qt(t,e,o)},set:function(t,e,o){return null==o?l(Rt,u,t,e):n(t)?t.then(l(Rt,u,e,o)):Rt(t,e,o)},pick:function(t,e){return null==e?c(Vt,u,t):n(t)?t.then(c(Vt,u,e)):Vt(t,e)},omit:function(t,e){return null==e?c(Kt,u,t):n(t)?t.then(c(Kt,u,e)):Kt(t,e)},map:hn,filter:function(n,t){return"function"==typeof n?c(Mn,u,n):Mn(n,t)},flatMap:(t,e)=>"function"==typeof t?c(tt,u,t):n(t)?t.then(c(tt,u,e)):tt(t,e),reduce:function(...t){return"function"==typeof t[0]?l(Dn,u,t[0],t[1]):n(t[0])?t[0].then(l(Dn,u,t[1],t[2])):Dn(t[0],t[1],t[2])},transform:function(...t){return"function"==typeof t[0]?l(Jn,u,t[0],t[1]):n(t[0])?t[0].then(l(Jn,u,t[1],t[2])):Jn(t[0],t[1],t[2])},and:function(...n){const o=n.pop();return I(o)?gt(o,-1):0==n.length?h(vt,u,o):t(n)?e(n).then(c(vt,u,o)):vt(n,o)},or:function(...n){const o=n.pop();return I(o)?xt(o,-1):0==n.length?h(bt,u,o):t(n)?e(n).then(c(bt,u,o)):bt(n,o)},not:function(...n){const o=n.pop();return"function"==typeof o?0==n.length?h(Mt,u,o):t(n)?e(n).then(c(Mt,u,o)):Mt(n,o):!o},some:function(t,e){return"function"==typeof t?c(at,u,t):n(t)?t.then(c(at,u,e)):at(t,e)},every:function(t,e){return"function"==typeof t?c(yt,u,t):n(t)?t.then(c(yt,u,e)):yt(t,e)},eq:Tt,gt:It,lt:Dt,gte:Pt,lte:Bt,thunkify:(n,...o)=>function(){return t(o)?e(o).then(c(r,n,u)):n(...o)},always:f,curry:Lt,__:u}}());
