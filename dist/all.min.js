/**
 * rubico v2.3.6
 * https://github.com/a-synchronous/rubico
 * (c) 2019-2024 Richard Tong
 * rubico may be freely distributed under the MIT license.
 */

!function(n,t){"object"==typeof module?module.exports=t:"function"==typeof define?define((()=>t)):n.all=t}("object"==typeof globalThis?globalThis:this,function(){"use strict";const n=n=>null!=n&&"function"==typeof n.then,t=function(t){const r=t.length;let o=-1;for(;++o<r;){const r=t[o];if(n(r))return!0}return!1},r=Promise.all.bind(Promise),o=Array.isArray,e=Symbol.for("placeholder"),u=function(n,t,r){return t==e?((n,t)=>function(r){return n(r,t)})(n,r):((n,t)=>function(r){return n(t,r)})(n,t)},c=function(n,t,r){return t==e?((n,t,r)=>function(...r){return n(r,t)})(n,r):((n,t,r)=>function(...r){return n(t,r)})(n,t)},i=function(t,o){const e=t.length,u=Array(e);let c=-1,i=!1;for(;++c<e;){const r=t[c](...o);n(r)&&(i=!0),u[c]=r}return i?r(u):u},f=(t,r)=>function(...o){const e=t(...o);return n(e)?e.then(r):r(e)},s=function(n,t,r,o){return t==e?((n,t,r)=>function(o){return n(o,t,r)})(n,r,o):r==e?((n,t,r)=>function(o){return n(t,o,r)})(n,t,o):((n,t,r)=>function(o){return n(t,r,o)})(n,t,r)},l=function(n,t,r){return n[t]=r,n},h=async function(t,r,o,e){const u=t.length;for(;++e<u;){const u=t[e](...r);o[e]=n(u)?await u:u}return o},a=function(t,r){const o=t.length,u=[];let c=-1;for(;++c<o;){const o=t[c](...r);if(n(o))return o.then(f(s(l,u,c,e),(i=h,p=r,g=e,y=c,(a=t)==e?((n,t,r,o)=>function(e){return n(e,t,r,o)})(i,p,g,y):p==e?((n,t,r,o)=>function(e){return n(t,e,r,o)})(i,a,g,y):g==e?((n,t,r,o)=>function(e){return n(t,r,e,o)})(i,a,p,y):((n,t,r,o)=>function(e){return n(t,r,o,e)})(i,a,p,g))));u[c]=o}var i,a,p,g,y;return u},p=function(t,o){const u={},c=[];for(const r in t){const i=t[r](...o);n(i)?c.push(i.then(s(l,u,r,e))):u[r]=i}return 0==c.length?u:r(c).then((i=u,function(){return i}));var i},g=function(...n){const f=n.pop();return 0==n.length?o(f)?c(i,f,e):c(p,f,e):t(n)?o(f)?r(n).then(u(i,f,e)):r(n).then(u(p,f,e)):o(f)?i(f,n):p(f,n)};return g.series=function(...n){const o=n.pop();return 0==n.length?c(a,o,e):t(n)?r(n).then(u(a,o,e)):a(o,n)},g}());
