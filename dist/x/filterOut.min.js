/**
 * rubico v1.8.9
 * https://github.com/a-synchronous/rubico
 * (c) 2019-2021 Richard Tong
 * rubico may be freely distributed under the MIT license.
 */

!function(n,t){"object"==typeof module?module.exports=t:"function"==typeof define?define((()=>t)):n.filterOut=t}("object"==typeof globalThis?globalThis:this,function(){"use strict";const n=Symbol.iterator,t=(t,o)=>({[n](){return this},next(){let n=t.next();for(;!n.done;){const{value:e}=n;if(o(e))return{value:e,done:!1};n=t.next()}return n}}),o=n=>null!=n&&"function"==typeof n.then,e=Symbol.asyncIterator,r=(n,t)=>({isAsyncIteratorDone:!1,[e](){return this},async next(){for(;!this.isAsyncIteratorDone;){const{value:e,done:r}=await n.next();if(r)this.isAsyncIteratorDone=!0;else{const n=t(e);if(o(n)?await n:n)return{value:e,done:!1}}}return{value:void 0,done:!0}}}),u=Array.isArray,c=Object.prototype.toString,i=n=>c.call(n),f=Symbol.for("placeholder"),s=function(n,t,o,e,r){return t==f?((n,t,o,e)=>function(r){return n(r,t,o,e)})(n,o,e,r):o==f?((n,t,o,e)=>function(r){return n(t,r,o,e)})(n,t,e,r):e==f?((n,t,o,e)=>function(r){return n(t,o,r,e)})(n,t,o,r):((n,t,o,e)=>function(r){return n(t,o,e,r)})(n,t,o,e)},l=Promise.all.bind(Promise),h=function(n,t,o,e){const r=t.length;let u=n.length-1;for(;++e<r;)n[++u]=o(t[e],e,n);return n},a=function(n,t,o,e){const r=n.length;let u=-1;for(;++o<r;)e[++u]&&t.push(n[o]);return t},y=function(n,t){const e=n.length,r=[];let u=-1,c=-1;for(;++u<e;){const e=n[u],i=t(e);if(o(i))return l(h([i],n,t,u)).then(s(a,n,r,u-1,f));i&&(r[++c]=e)}return r},p=function(n,t,o,e){return t==f?((n,t,o)=>function(e){return n(e,t,o)})(n,o,e):o==f?((n,t,o)=>function(e){return n(t,e,o)})(n,t,e):((n,t,o)=>function(e){return n(t,o,e)})(n,t,o)},d=(n,t,o)=>n?t():o(),g=n=>function(){return n},b=(n,t,o)=>n[t](o),j=(n,t)=>function(){return n(t)},m=function(){},v=(n,t,o,e,r)=>function(){return n(t,o,e,r)},w=(n,t,o,e)=>n[t](o,e),x=function(n,t,o,e){e&&(n[t]=o)},A=function(n,t,o,e){const r=t.length;let u=n.length-1;for(;++e<r;)n[++u]=o(t[e],e,t);return n},S=c=>function(h){return u(h)?y(h,c):"function"==typeof h?(n=>"[object GeneratorFunction]"==i(n))(h)?((n,o)=>function*(...e){yield*t(n(...e),o)})(h,c):(n=>"[object AsyncGeneratorFunction]"==i(n))(h)?((n,t)=>async function*(...o){yield*r(n(...o),t)})(h,c):((n,t)=>function(e,r){const u=t(r);return o(u)?u.then(p(d,f,(c=n,i=e,s=r,function(){return c(i,s)}),g(e))):u?n(e,r):e;var c,i,s})(h,c):null==h?h:"string"==typeof h||h.constructor==String?function(n,t){const e=y(n,t);return o(e)?e.then(p(b,f,"join","")):e.join("")}(h,c):h.constructor==Set?function(n,t){const e=new Set,r=e.add.bind(e),u=[];for(const c of n){const i=t(c,c,n);o(i)?u.push(i.then(p(d,f,j(r,c),m))):i&&e.add(c)}return 0==u.length?e:l(u).then(g(e))}(h,c):h.constructor==Map?function(n,t){const e=new Map,r=[];for(const[u,c]of n){const i=t(c,u,n);o(i)?r.push(i.then(p(d,f,v(w,e,"set",u,c),m))):i&&e.set(u,c)}return 0==r.length?e:l(r).then(g(e))}(h,c):"function"==typeof h.filter?h.filter(c):"function"==typeof h[n]?t(h[n](),c):"function"==typeof h[e]?r(h[e](),c):h.constructor==Object?function(n,t){const e={},r=[];for(const u in n){const c=n[u],i=t(c,u,n);o(i)?r.push(i.then(s(x,e,u,n[u],f))):i&&(e[u]=c)}return 0==r.length?e:l(r).then(g(e))}(h,c):h};S.withIndex=n=>function(t){if(u(t))return function(n,t){const e=n.length,r=[];let u=-1,c=-1;for(;++u<e;){const e=n[u],i=t(e,u,n);if(o(i))return l(A([i],n,t,u)).then(s(a,n,r,u-1,f));i&&(r[++c]=e)}return r}(t,n);throw new TypeError(`${t} is not an Array`)};const I=n=>!n,D=n=>function(t){if(null!=t&&"function"==typeof t.not)return t.not(n);const e=n(t);return o(e)?e.then(I):!e};D.sync=n=>function(...t){return!n(...t)};return n=>S(D(n))}());
